<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- tree of payments -->
    <record id="view_account_payment_tree" model="ir.ui.view">
        <field name="name">account.payment.list</field>
        <field name="model">account.payment</field>
        <field name="inherit_id" ref="account.view_account_payment_tree"/>
        <field name="arch" type="xml">
            <list>
                <field name="payment_method_code" column_invisible="1"/>
                <field name="partner_type" column_invisible="1"/>
            </list>
        </field>
    </record>

    <record id="view_account_payment_form" model="ir.ui.view">
        <field name="name">account.payment.form.inherited</field>
        <field name="model">account.payment</field>
        <field name="priority" eval="30"/>
        <field name="inherit_id" ref="account.view_account_payment_form" />
        <field name="arch" type="xml">
            <field name="memo" position="after">
                <field name="l10n_ve_withholding_islr" invisible="partner_type == 'customer'"/>
                <field name="l10n_ve_withholding_distribution_islr" invisible="not l10n_ve_withholding_islr" />
                <field name="l10n_ve_third_partner_withholding" invisible="partner_type == 'customer'" />
                <field name="l10n_ve_third_partner_id" invisible="not l10n_ve_third_partner_withholding"/>
                <field name="l10n_ve_partner_regimen_islr_ids" invisible="True"/>
            </field>
            <label for="payment_total" position="before">
                <field name="l10n_ve_withholdings_amount" invisible="is_internal_transfer or not use_payment_pro or country_code != 'VE'"/>
            </label>
            <page name="latam_checks_page" position="after">
                <page name="withholdings_page" string="Withholdings" invisible="is_internal_transfer or not use_payment_pro or country_code != 'VE'">
                    <group>
                        <group>
                            <label for="l10n_ve_withholdable_advanced_amount" invisible="state not in ['draft'] or partner_type != 'supplier' or unreconciled_amount &lt;= 0.0"/>
                            <div name="l10n_ve_withholdable_advanced_amount" invisible="state not in ['draft'] or partner_type != 'supplier' or unreconciled_amount &lt;= 0.0">
                                <field name="l10n_ve_withholdable_advanced_amount" readonly="state not in ['draft']" string="Base imponible del pago excedente" class="oe_inline"/>
                                <span invisible="state != 'draft'" class="text-muted"> (del excedente <field name="unreconciled_amount" force_save="True" readonly="True" class="oe_inline"/>)</span>
                            </div>
                        </group>
                    </group>
                    <field name="l10n_ve_withholding_line_ids" nolabel="1" colspan="2" invisible="is_internal_transfer" readonly="state != 'draft'">
                        <list editable="bottom">
                            <field name="calc_islr" column_invisible="True" />
                            <field name="l10n_ve_tax_type" column_invisible="True" />
                            <field name="withholding_sequence_id" column_invisible="True"/>
                            <field name="company_id" column_invisible="True"/>
                            <field name="currency_id" column_invisible="True"/>
                            <field name="tax_id" domain="[('l10n_ve_withholding_payment_type', '=', parent.partner_type), ('company_id', 'parent_of', parent.company_id)]" options="{'no_create': True}"/>
                            <field name="l10n_ve_concept_withholding" column_invisible="not parent.l10n_ve_withholding_islr" readonly="l10n_ve_tax_type == 'partner_tax'" />
                            <field name="move_line_id" column_invisible="True" />
                            <field name="product_id"
                                optional="show"
                                column_invisible="not parent.l10n_ve_withholding_distribution_islr"
                                />
                            <field name="l10n_ve_regimen_islr_id"
                                column_invisible="not parent.l10n_ve_withholding_islr"
                                readonly="l10n_ve_tax_type == 'partner_tax'"
                                domain="[('id', 'in', parent.l10n_ve_partner_regimen_islr_ids)]"
                                options="{'no_create': True}"
                                />
                            <field name="name" readonly="withholding_sequence_id" required="parent.partner_type == 'customer'" />
                            <field name="base_amount" column_invisible="parent.partner_type != 'supplier'"/>
                            <field name="amount" readonly="parent.partner_type == 'supplier'" force_save="1"/>
                            <field name="ref" optional="hide"/>
                            <button name="%(action_report_withholding_certificate_iva)d" invisible="l10n_ve_tax_type != 'partner_tax'" icon="fa-print " title="Imprimir comprobante IVA" type="action" />
                            <button name="%(action_report_withholding_certificate)d" invisible="l10n_ve_tax_type != 'tabla_islr'" icon="fa-print " title="Imprimir comprobante ISLR" type="action" />
                        </list>
                    </field>
                </page>
            </page>
        </field>
    </record>
</odoo>

